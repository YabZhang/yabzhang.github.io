<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="最近需要实现网页自动化操作，直接 hack 网站接口不太好搞，于是到处找 UI 操作自动化的解决方案。
一开始我在桌面系统上来解决这个事，最好支持操作的录制和重放。一通搜索发现确实有戏，Mac 系统自带了 Automator 可以完成 脚本录制 和 操作重放；Win 系统也有不少很好的桌面软件支持。看来各生态都有这类自动化的方案。
我的笔记本是 Mac ，我简单测试了 Automator 算不上完美，不过一般常见也够用。 除了支持基本 UI 交互录制，还开放了部分系统和应用的功能支持，也可以通过脚本拓展。对于个人办公场景，这套工具可以满足大部分场景，且尽可能不用编写代码。不过因为是系统绑定，以后不方便丢到 VPS 执行，也不方便服务化和规模化。
我确认过全任务流程可以调整为全部在浏览器里完成，这不就是 Web 自动化测试嘛。 提到 Web UI 自动化, 那就不得不提一下大名鼎鼎的 Selenium 了 ———— 提供了一系列与浏览器交互的接口并能模拟各种用户行为，有着庞大的开源社区生态。但近年来，微软开源的 Playwright1 同样支持与浏览器交互和用户行为模拟，且功能更为强大和便于使用。使用示例如下：
启动浏览器录制交互，实时生成交互代码 # 打开youtube页面，并开始录制操作脚本 playwright codegen https://www.youtube.com # 支持很多浏览器参数，加载原有Session, 并开始录制 playwright codegen --load-session=cookies.json https://www.youtube.com 他甚至支持导出测试视频 😂 context = browser.new_context( record_video_dir=&#34;videos/&#34;, record_video_size={&#34;width&#34;: 640, &#34;height&#34;: 480} ) 支持 pytest 插件，可以方便的整合测试用例 pytest --browser webkit --headed
还有更多其他丰富特性，可以说强大到叹为观止。绝对是当前 Web 自动化测试不二之选。"><title>Playwright 笔记</title><link rel="shortcut icon" type=image/x-icon href=/><link rel=stylesheet href=/css/main.ebe15b0394daa6798b8a40aa572a71b5a7a1beb8cc02c392f5c142e7d08ddb6052e049639385106440b538f394884685082b7441eef27a6a8315ec723155dc15.css integrity="sha512-6+FbA5TapnmLikCqVypxtaehvrjMAsOS9cFC59CN22BS4Eljk4UQZEC1OPOUiEaFCCt0Qe7yemqDFexyMVXcFQ=="></head><body a=auto><main class=page-content aria-label=Content><div class=w><a href=/>..</a><article><p class=post-meta><time datetime="2023-07-15 01:35:10 +0800 +0800">2023-07-15</time></p><h1>Playwright 笔记</h1><p>最近需要实现网页自动化操作，直接 hack 网站接口不太好搞，于是到处找 UI 操作自动化的解决方案。</p><p>一开始我在桌面系统上来解决这个事，最好支持操作的录制和重放。一通搜索发现确实有戏，Mac 系统自带了 <code>Automator</code> 可以完成 脚本录制 和 操作重放；Win 系统也有不少很好的桌面软件支持。看来各生态都有这类自动化的方案。</p><p>我的笔记本是 Mac ，我简单测试了 <code>Automator</code> 算不上完美，不过一般常见也够用。
除了支持基本 UI 交互录制，还开放了部分系统和应用的功能支持，也可以通过脚本拓展。对于个人办公场景，这套工具可以满足大部分场景，且尽可能不用编写代码。不过因为是系统绑定，以后不方便丢到 VPS 执行，也不方便服务化和规模化。</p><p>我确认过全任务流程可以调整为全部在浏览器里完成，这不就是 Web 自动化测试嘛。
提到 Web UI 自动化, 那就不得不提一下大名鼎鼎的 <code>Selenium</code> 了 ———— 提供了一系列与浏览器交互的接口并能模拟各种用户行为，有着庞大的开源社区生态。但近年来，微软开源的 <code>Playwright</code><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> 同样支持与浏览器交互和用户行为模拟，且功能更为强大和便于使用。使用示例如下：</p><ol><li>启动浏览器录制交互，实时生成交互代码</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># 打开youtube页面，并开始录制操作脚本</span>
</span></span><span style=display:flex><span>playwright codegen https://www.youtube.com
</span></span><span style=display:flex><span><span style=color:#75715e># 支持很多浏览器参数，加载原有Session, 并开始录制</span>
</span></span><span style=display:flex><span>playwright codegen --load-session<span style=color:#f92672>=</span>cookies.json https://www.youtube.com
</span></span></code></pre></div><ol start=2><li>他甚至支持导出测试视频 😂</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>context <span style=color:#f92672>=</span> browser<span style=color:#f92672>.</span>new_context(
</span></span><span style=display:flex><span>    record_video_dir<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;videos/&#34;</span>,
</span></span><span style=display:flex><span>    record_video_size<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;width&#34;</span>: <span style=color:#ae81ff>640</span>, <span style=color:#e6db74>&#34;height&#34;</span>: <span style=color:#ae81ff>480</span>}
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><ol start=3><li>支持 <code>pytest</code> 插件，可以方便的整合测试用例</li></ol><p><code>pytest --browser webkit --headed</code></p><p>还有更多其他丰富特性，可以说强大到叹为观止。绝对是当前 Web 自动化测试不二之选。</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Playwright: <a href=https://playwright.dev/python/docs/intro>https://playwright.dev/python/docs/intro</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article></div></main></body></html>