<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>C on yabzhang</title><link>https://yabzhang.github.io/tags/c/</link><description>Recent content in C on yabzhang</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Sat, 04 Nov 2023 23:35:15 +0800</lastBuildDate><atom:link href="https://yabzhang.github.io/tags/c/index.xml" rel="self" type="application/rss+xml"/><item><title>smallchat 源码阅读</title><link>https://yabzhang.github.io/posts/project/reading_smallchat/</link><pubDate>Sat, 04 Nov 2023 23:35:15 +0800</pubDate><guid>https://yabzhang.github.io/posts/project/reading_smallchat/</guid><description>smallchat1 是 redis 作者 antirez 所写的一个聊天室的小程序；代码短小精悍，很有意思。据说作者以此例向前端朋友展示系统编程的趣味 😄 2~
这里记录下阅读源码所获。
首先从 main 开始:
/* The main() function implements the main chat logic: * 1. Accept new clients connections if any. * 2. Check if any client sent us some new message. * 3. Send the message to all the other clients. */ int main(void) { initChat(); while(1) { ... } return 0; } 根据注释，main 函数主要做了三件事：
接受新的客户端连接； 检查是否有客户端发送过来新的消息； 发送消息给其他客户端； 代码首先调用了 initChat 完成一些初始化工作；然后程序进入到死循环，作为常驻服务，会不停执行消息逻辑。主题结构大体是这样。</description></item></channel></rss>